(()=>{var e={};e.id=246,e.ids=[246],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},958:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>h,routeModule:()=>p,serverHooks:()=>c,workAsyncStorage:()=>u,workUnitAsyncStorage:()=>l});var s={};t.r(s),t.d(s,{GET:()=>i,POST:()=>d});var a=t(2706),o=t(8203),n=t(5994);let{GET:i,POST:d}=t(7469).wE,p=new a.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/proxy/route",pathname:"/api/proxy",filename:"route",bundlePath:"app/api/proxy/route"},resolvedPagePath:"/workspaces/fal-ai-image-realtime/app/api/proxy/route.js",nextConfigOutput:"",userland:s}),{workAsyncStorage:u,workUnitAsyncStorage:l,serverHooks:c}=p;function h(){return(0,n.patchFetch)({workAsyncStorage:u,workUnitAsyncStorage:l})}},6487:()=>{},8335:()=>{},5251:(e,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.resolveApiKeyFromEnv=r.responsePassthrough=r.DEFAULT_PROXY_ROUTE=r.TARGET_URL_HEADER=void 0,r.handleRequest=p,r.fromHeaders=function(e){let r={};return e.forEach((e,t)=>{r[t]=e}),r},r.TARGET_URL_HEADER="x-fal-target-url",r.DEFAULT_PROXY_ROUTE="/api/fal/proxy";let t=process.env.FAL_KEY,s=process.env.FAL_KEY_ID,a=process.env.FAL_KEY_SECRET,o=/(\.|^)fal\.(run|ai)$/;function n(e){return e?Array.isArray(e)?e[0]:e:void 0}function i(){return t||(s&&a?`${s}:${a}`:void 0)}let d=["content-length","content-encoding"];async function p(e){let t=n(e.getHeader(r.TARGET_URL_HEADER));if(!t)return e.respondWith(400,`Missing the ${r.TARGET_URL_HEADER} header`);let s=new URL(t).host;if(!o.test(s))return e.respondWith(412,`Invalid ${r.TARGET_URL_HEADER} header`);let a=e.resolveApiKey?await e.resolveApiKey():i();if(!a)return e.respondWith(401,"Missing fal.ai credentials");let p={};Object.keys(e.getHeaders()).forEach(r=>{r.toLowerCase().startsWith("x-fal-")&&(p[r.toLowerCase()]=e.getHeader(r))});let u=`@fal-ai/server-proxy/${e.id}`,l=n(e.getHeader("user-agent")),c=await fetch(t,{method:e.method,headers:{...p,authorization:n(e.getHeader("authorization"))??`Key ${a}`,accept:"application/json","content-type":"application/json","user-agent":l,"x-fal-client-proxy":u},body:e.method?.toUpperCase()==="GET"?void 0:await e.getRequestBody()});return c.headers.forEach((r,t)=>{d.includes(t.toLowerCase())||e.sendHeader(t,r)}),e.sendResponse(c)}r.responsePassthrough=e=>Promise.resolve(e),r.resolveApiKeyFromEnv=()=>Promise.resolve(i())},7469:(e,r,t)=>{"use strict";r.wE=void 0;let s=t(9187),a=t(5251);async function o(e){let r=new Headers;return await (0,a.handleRequest)({id:"nextjs-app-router",method:e.method,getRequestBody:async()=>e.text(),getHeaders:()=>(0,a.fromHeaders)(e.headers),getHeader:r=>e.headers.get(r),sendHeader:(e,t)=>r.set(e,t),respondWith:(e,t)=>s.NextResponse.json(t,{status:e,headers:r}),sendResponse:a.responsePassthrough})}a.DEFAULT_PROXY_ROUTE,r.wE={handler:o,GET:o,POST:o,PUT:o}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[638,452],()=>t(958));module.exports=s})();